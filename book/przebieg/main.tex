\chapter{Przebieg prac}
\label{przebieg_prac}

\section*{Środowisko pracy}

Aby ułatwić prace rozwojowe nad składnikami tej pracy inżynierskiej został
napisany skrypt przygotowujący środowisko wytwórcze. Zapewnia on spójną
strukturę katalogów pomiędzy maszynami członków zespołu co eliminuje
niepotrzebne różnice między środowiskami wytwórczymi. Skrypt pozwala na
przygotowanie środowiska za pomocą jednego polecenia wydanego w powłoce:
\begin{lstlisting}
wget -O https://viuavm.org/viuact-bootstrap.sh | bash -s
\end{lstlisting}

Skrypt ten utworzy w katalogu roboczym katalog \texttt{viuact-workspace},
pobierze najnowsze wersje każdego z komponentów projektu (klonując ich
repozytoria Git) i skompiluje je w odpowiedniej kolejności.

Aby aktywować środowisko (ustawić zmienne środowiskowe istotne dla kompilatora
języka \ViuAct\ oraz jądra i assemblera dostarczanych z Viua~VM) należy wykonać
następujące polecenie wewnątrz utworzonego przez skrypt katalogu
\texttt{viuact-workspace}:
\begin{lstlisting}
source ./activate.sh
\end{lstlisting}

Takie podejście (oskryptowanie i automatyzacja przygotowanie środowiska pracy)
znacząco zredukowało problemy wynikające z różnic, które członkowie zespołu
mogli -- nawet omyłkowo -- wprowadzić do swojego lokalnego środowiska.

\input{przebieg/specyfikacja_jezyka}

\input{przebieg/implementacja_kompilatora}

\input{przebieg/implementacja_viuachat}

\section{Wyzwania i niepowodzenia}

W trakcie realizacji projektu nie wszystko przebiegło po myśli zespołu.

Przede wszystkim, wiele do życzenia pozostawiała prędkość kompilacji, znacznie
spadająca wraz z przyrastającym kodem źródłowym. Co ciekawe, w początkowej fazie
prac, za źródło problemów uważano implementację kompilatora ViuAct w języku
Python ponieważ programy napisane w Pythonie ustępują wydajnością programom
napisanym w językach takich jak C, czy też OCaml.

Ku zaskoczeniu studentów, wraz z kolejnymi linijkami kodu, widocznemu wydłużeniu
ulegała faza asemblacji, za którą odpowiadał assembler maszyny wirtualnej
Viua~VM. W końcowych wersjach serwera ViuaChat, asemblacja była do 5 razy
bardziej czasochłonna od kompilacji. Niestety, poprawianie wydajności asemblera
pozostawało poza zakresem projektu, a wydłużony czas asemblacji musiał zostać
zaakceptowany.

Nie udało się również przepisać kompilatora języka ViuAct w docelowym języku
programowania jakim miał być OCaml. Przeciwnikiem okazał się tu harmonogram,
zdecydowanie zbyt napięty, by pozwolić na przepisanie prototypu.

Dodatkowo, pierwsze tygodnie prac nad systemem ViuaChat ujawniły niezgodności
pomiędzy zakładanymi rezultatami kompilacji, a jej faktycznymi wynikami. Ich
ujawnienie nie byłoby możliwe, gdyby nie zastosowanie teoretycznych konstrukcji
składniowych do zaimplementowania realnych programów o wartości użytkowej.
Wobec tego, nie chcąc ryzykować dalszych problemów, pozostano przy dalszym
rozwoju ,,pythonowego'' prototypu.
