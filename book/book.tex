\documentclass[11pt,oneside,a4paper,titlepage,onecolumn]{book}

\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\usepackage[official]{eurosym}
\usepackage[polish]{babel}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage[T1]{fontenc}
\usepackage{scrextend}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{enumitem}
% \usepackage{nameref}
% \usepackage{showlabels}
% \usepackage{titlesec}
\usepackage{geometry}
\geometry{a4paper, portrait, margin=2cm}
\graphicspath{ {./fig/} }
\usepackage{listings}

\newenvironment{enumreq}
{ \begin{enumerate}[topsep=0pt,itemsep=-1ex,partopsep=1ex,parsep=1ex] }
{ \end{enumerate}                  } 

\newcommand{\inzmaintitlePL}{Viua VM w akcji}

\setcounter{secnumdepth}{4}

%% Author and title
% \author{Marek Marecki \and Gr.52c \and Krzysztof Franek}
\author{Zespół: Marek Marecki i Krzysztof Franek\\Promotor: dr hab. Marek A. Bednarczyk, prof. PJWSTK}
\title{%
    \inzmaintitlePL \\
    \large
    Implementacja języka wysokiego poziomu i \\
    realizacja prostej aplikacji\\
    ~\\
    Viua VM in action. Implementation of a high-level programming language and\\ a simple application}

\begin{document}

\lstset{basicstyle=\ttfamily,
columns=fixed,
escapeinside={\%*}{*)},
inputencoding=utf8,
extendedchars=true}

\maketitle

\tableofcontents
% \listoftables
\listoffigures

Praca została złożona za pomocą systemu \LaTeX.

\newpage

\chapter{Wprowadzenie}

We wprowadzeniu chcielibyśmy poruszyć ogólne tematy związane z naszą pracą, oraz przedstawić Czytelnikowi
spójny wstęp zapewniający solidne podstawy do dalszej lektury. Zakładamy, że Czytelnik ma doświadczenie z
językami programowania i umie biegle posługiwać się co najmniej jednym ''\emph{mainstreamowym}'' językiem, np.
C++, Java, czy Python.

Wprowadzenie jest dla nas miejscem, w którym przedstawimy problemy dręczące popularne obecnie języki
programowania oraz powiemy skąd się te problemy biorą i dlaczego w miarę postępu technologii są one coraz
trudniejsze do zignorowania.

Po krótce przedstawiona zostanie również maszyna wirtualna Viua, która jest platformą, na której nasza praca
się opiera.

\section{Układ pracy inżynierskiej}

W rozdziale \ref{jezyk_viuact_i_jego_kompilator}.~\nameref{jezyk_viuact_i_jego_kompilator} (na stronie
\pageref{jezyk_viuact_i_jego_kompilator}) przedstawiamy język Viuact oraz jego implementację - kompilator.
Są to narzędzia wykorzystywane do stworzenia aplikacji użytkowej przedstawionej w rozdziale
\ref{program_viuachat}.~\nameref{program_viuachat} (na stronie \pageref{program_viuachat}).

Wkład własny członków zespołu przedstawiony jest w rozdziale \ref{wklad_wlasny_czlonkow_zespolu} na stronie
\pageref{wklad_wlasny_czlonkow_zespolu}.

W rozdziale \ref{slownik_pojec}.~\nameref{slownik_pojec} na stronie \pageref{slownik_pojec} prezentujemy listę
pojęć i terminów używanych w pracy, które mogą wymagać doprecyzowania lub definicji. Dla wygody Czytelnika są
one umieszczone w jednym miejscu, oraz podzielone na sekcje związane z językiem i kompilatorem
(rozdział~\ref{slownik_pojec_jezyka}) i związane z chatem (rozdział~\ref{slownik_pojec_chatu}).

\section{Przedstawienie problemu}

Tytułem pracy jest ,,\inzmaintitlePL''. Problemem, który poruszamy jest sprawdzenie czy Viua VM w stanie
,,zastanym'' (tj. w takim w jakim znajdowała się jej implementacja na początku prac nad projektem
inżynierskim) umożliwia pisanie niezawodnego, wysoce współbieżnego, nietrywialnego oprogramowania.

W naszej pracy prezentujemy język programowania, który z założenia ma pozwalać na tworzenie oprogramowania
niezawodnego i wykorzystującego potencjał współbieżności w stopniu wyższym niż powszechnie używane,
,,mainstreamowe'' języki programowania.

Aby udowodnić, że w wytworzonym języku możliwe jest tworzenie nietrywialnego oprogramowania prezenetujemy
aplikację użytkową -- czat -- napisany w tym języku. Czat umożliwi komunikację (zorganizowaną kanałach) wielu
użytkownikom naraz. Wybór rodzaju aplikacji (czat) jest warunkowany tym, że oprogramowanie komunikacyjne
powinno charakteryzować się tymi cechami, które chcemy uzyskać:

\begin{enumerate}
    \item niezawodnością -- jeśli jedno połączenie ulegnie awarii to pozostałe powinny działać dalej
    \item izolacją procesów -- każde połączenie powinno być izolowane od wszystkich innych
    \item współbieżnością -- wiele połączeń musi być obsługiwanych w tym samym czasie
\end{enumerate}

\subsection{Ogląd sytuacji}

Współczesny \emph{hardware} zmierza coraz bardziej w stronę współbieżności oraz przetwarzania równoległego.
Firma AMD w roku 2018 wprowadziła na rynek konsumencki procesory wielordzeniowe z serii
Threadripper\footnote{https://www.amd.com/en/products/ryzen-threadripper} prezentujące nawet 32 rdzenie logiczne.

Współczesny \emph{software} stoi w miejscu. Poza oprogramowaniem specjalistycznym (np.
Blender\footnote{https://www.blender.org/}) mało który program jest w stanie wykorzystać więcej niż kilka wątków.
Współbieżności szuka się nieco ''na siłę''; np. przeglądarki internetowe uruchamiają współbieżnie obsługę
wielu kart.

Mainstreamowe języki w większości korzystają z wątków (np. Java, C++) lub są stricte jednowątkowe i
niedostosowane do przetwarzania współbieżnego i równoległego (np. Python).

Dla takich języków tworzone są biblioteki ułatwiające wykorzystanie mechanizmów systemu operacyjnego
(np.~wieloprocesowość dla języka Python) lub cała infrastruktura umożliwiająca rozproszenie pracy,
np.~sewery pracy (np. Gearman, Celery) czy kolejki wiadomości (np. RabbitMQ, ZeroMQ).
To wszystko są jednak jedynie ''łatki'' mające za zadanie dodać do istniejących języków mechanizmy, z którymi
pierwotnie nie były one projektowane. Istnieje dla takiego działania angielski termin bardzo dobrze oddający
jego postać: \emph{retrofitting}.

Istnieją środowiska i języki zaprojektowane od zera z myślą o współbieżności i przetwarzaniu równoległym, a
nawet rozproszonym.
Najbardziej znanym przykładem takiego środowiska jest BEAM -- maszyna wirtualna
języka Erlang\footnote{http://www.erlang.org/}. To środowisko wraz z językiem jest z powodzeniem
wykorzystywane w sprzęcie telekomunikacyjnym firmy Ericsson, oraz do tworzenia aplikacji użytkowych, których
działanie obejmuje niemal z definicji działanie rozproszone i współbieżne, na przykład w serwerach
komunikatora Discord\footnote{https://discordapp.com/}.

\section{Cel}

Ta praca inżynierska motywowana jest chęcią stworzenia bazy programistycznej (środowiska uruchomieniowego i
języka programowania) umożliwiającej programistom pisanie oprogramowania od początku uwzględniającego
przetwarzanie współbieżne na pierwszym miejscu, oraz charakteryzującego się wysokim poziomem niezawodności i
stabliności działania.

Osiągniemy to dzięki zbudowaniu języka wyposażonego w łatwo dostępne konstrukcje umożliwiające wprowadzenie
współbieżności do programu, oraz uruchamianiu programów wynikowych w środowisku zdolnym do rozłożenia pracy na
całość dostępnych zasobów sprzętowych.

\subsection{Problemy i ryzyko}

Postawienie współbieżności na pierwszym miejscu powoduje, że problemy związane z pisaniem poprawnych programów
są bardziej liczne niż w innych (niewspółbieżnych) językach -- oprócz zapewnienia poprawności pojedynczego
procesu, programista musi zadbać o poprawność interakcji między procesami, oraz o stabilność działania
oprogramowania w momencie awarii któregoś z procesów składowych programu.

Zminimalizujemy ryzyko płynące z wprowadzenia współbieżności do warsztatu programistów udostępniając im
mechanizmy umożliwiające opanowanie awarii, propagowanie informacji o błędach, oraz izolację poszczególnych
procesów składowych.

\chapter{Strategia prowadzenia prac}

W tym rozdziale opisujemy metodologię prac nad poszczególnymi częściami projektu. Każda z nich była rozwijana
innym sposobem z dużych rozbieżności specyfiki konkretnych problemu -- zupełnie inaczej pracuje się nad
semi-formalną specyfikacją języka programowania niż nad aplikacją użytkową, więc podjęliśmy decyzję o
rozdzieleniu tych części i poprowadzeniu ich jako osobne, mniejsze projekty wewnątrz pracy inżynierskiej.

\section{Język ViuAct}

% Specyfikacja. Analiza wymagań. Formalizm. Kaskada.

Tworzenie specyfikacji języka odbywa się w modelu kaskadowo-prototypowym i przeplata się z implementacją
prototypu kompilatora.

\subsection{Określenie wymagań}

Przed rozpoczęciem specyfikowania poszczególnych konstrukcji językowych należało podjąć decyzję co w języku
powinno się znaleźć, a co nie powinno zostać włączone do specyfikacji.

\subsection{Specyfikacja konkretnej konstrukcji języka}

Każda konstrukcja językowa jest najpierw projektowana, następnie dokumentowana i omawiana (żeby wychwycić
pewne oczywiste błędy ,,grube'' na wczesnym etapie prac). Potem proces specyfikacji zostaje zawieszony do
momentu wytworzenia w kompilatorze prototypu danej konstrukcji, lub odrzucenia jej jako niewykonalnej w
zakładanym czasie lub zakresie funkcjonalności.

Wynik prac prototypowych (sukces bądź porażka) decyduje o tym czy prace specyfikacyjne są prowadzone dalej.
Jeśli konstrukcja jest możliwa do zaimplementowania jej specyfikacja jest formalizowana oraz przygotowana dla
niej zostaje dokumentacja (obejmująca m.in. przykłady użycia).

\section{Kompilator języka ViuAct}

Issue tracking, open-source. Prototypowanie. Iteracja.
Prace przeplatają się z pracami nad specyfikacją celem walidacji co jest możliwe.

\subsection{Testowanie}

Zestaw prostych programów testowych. Test sprawdza czy program się kompiluje i czy po uruchomieniu daje
spodziewane wyniki.

\section{Program ViuaChat}

Mini-SCRUM.

\subsection{Testowanie}

Jak wygląda testowanie czatu.

\chapter{Dokumentacja prac}

\section{Specyfikacja języka ViuAct}

Tworzenie formalnej specyfikacji języka ViuAct było, paradoksalnie, procesem mało sformalizowanym. Polegało
na określeniu głównych założeń języka (opisanych w rozdziale
\ref{specyfikacja_jezyka_viuact_model_programowania}
\nameref{specyfikacja_jezyka_viuact_model_programowania}).

\section{Implementacja kompilatora}

Issue tracking. Zapis issue, daty rozpoczęcia i zakończenia, branche z Git. Trochę słowno-muzycznego opisu co
się działo podczas prac.

\section{Implementacja ViuaChat}

Opis prac nad implementacją ViuaChat.

\chapter{Język ViuAct i jego kompilator -- formalności}

W tym rozdziale prezentujemy wszelkie ''formalności'' związane z pierwszą częścią naszej pracy, czyli
dokumenty takie jak DZW\footnote{Dokument Założeń Wstępnych} czy SWS\footnote{Spis Wymagań Systemowych}.
Opis projektu języka i jego implementacji prezentujemy w rozdziale \nameref{jezyk_viuact_i_jego_kompilator} na
stronie~\pageref{jezyk_viuact_i_jego_kompilator}.

\include{viuact/sws}

\include{viuact/language_specification}

\chapter{Język ViuAct i jego kompilator}
\label{jezyk_viuact_i_jego_kompilator}

Pierwszą częścią naszej pracy jest zaprojektowanie wysokopoziomowego języka programowania i opracowanie jego
implementacji. Z uwagi na to, że platforma uruchomieniowa, którą wykorzystujemy (czyli Viua VM) jest maszyną
wirtualną wykonującą programy w postaci \emph{bytecode} wybranym sposobem implementacji języka jest
kompilator - program tłumaczący kod źródłowy w jednym języku na kod źródłowy w innym języku przy jednoczesnym
zachowaniu zachowania programu. W przypadku naszej pracy językiem źródłowym jest język Viuact (dokładniej
opisany w rozdziale \ref{specyfikacja_jezyka_viuact}.~\nameref{specyfikacja_jezyka_viuact} na stronie
\pageref{specyfikacja_jezyka_viuact}), a językiem docelowym język assemblera Viua VM.

\include{viuact/ps/architektura}

\include{viuact/ps}

\section{Testowanie}

Testy kompilatora.

\subsection{Zestaw przypadków testowych}

Jeden testowy program na każdą funkcjonalność języka.
Kilka większych testowych programów sprawdzających integrację języka, np. wielomodułowych, wykorzystujących
moduły obce.

\subsection{Wykonanie testów}

Opis tego jak wygląda uruchomienie testów, w jaki sposób został zbudowany framework, itp.

\subsection{Trudności w testowaniu}

Niedeterminizm wynikający z równoległego działania aktorów stwarza problemy w testach. Trzeba uciekać się do
"sztuczek", np. sortowanie wyników programu testowego.

\include{viuact/manual}

\chapter{Program ViuaChat -- formalności}

\include{chat/sws}

\chapter{Program ViuaChat}
\label{program_viuachat}

Drugą częścią naszej pracy jest program ViuaChat - chat internetowy o funkcjonalności podobnej do IRC.
Umożliwia użytkownikom logowanie się do sieci, zakładanie pokojów tematycznych do rozmów, oraz rozmowy
''prywatne'' (tj. wyłączne dla dwóch użytkowników).

\include{chat/ps}

\include{chat/spu}

\chapter{Wkład własny członków zespołu}
\label{wklad_wlasny_czlonkow_zespolu}

\section{Krzysztof Franek}

\section{Marek Marecki}

\include{common/glossary}

\chapter{Bibliografia}

Książki. Internetowe materiały. Materiały wykładowe. Opracowania własne.

\end{document}
